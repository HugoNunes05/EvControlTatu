# üß± Dockerfile para o projeto EvControl (Spring Boot + Java 21 + PostgreSQL Neon)

# 1Ô∏è‚É£ Usa imagem base com JDK 21 (oficial da Eclipse Temurin)
FROM eclipse-temurin:21-jdk

# 2Ô∏è‚É£ Define o diret√≥rio de trabalho no container
WORKDIR /app

# 3Ô∏è‚É£ Copia arquivos do Maven Wrapper e o pom.xml
COPY mvnw .
COPY .mvn/ .mvn/
COPY pom.xml .

# 4Ô∏è‚É£ Faz download das depend√™ncias antes do c√≥digo (acelera o build)
RUN chmod +x mvnw && ./mvnw dependency:go-offline -B

# 5Ô∏è‚É£ Copia o c√≥digo fonte para dentro do container
COPY src ./src

# 6Ô∏è‚É£ Compila o projeto e gera o .jar (ignorando testes)
RUN ./mvnw clean package -DskipTests

# 7Ô∏è‚É£ Exp√µe a porta padr√£o usada pelo Spring Boot
EXPOSE 8080

# 8Ô∏è‚É£ Define vari√°veis de ambiente (Render vai sobrescrever com as suas)
ENV SPRING_PROFILES_ACTIVE=prod

# 9Ô∏è‚É£ Executa o JAR gerado (de acordo com seu pom.xml)
CMD ["java", "-jar", "target/evcontrol-0.0.1-SNAPSHOT.jar"]